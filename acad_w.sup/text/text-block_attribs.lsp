(defun c:normalize_text	 (/ ed en)
  (setq	en (car (entsel "Выберите блок с атрибутами:"))
	ed (entget en))
  (if (/= "INSERT" (cdr (assoc 0 ed)))
    (progn (princ "Объект не является блоком!") (exit)))
  (if (null (setq en (entnext en)))
    (exit)
    (setq ed (entget en)))
  (while (= "ATTRIB" (cdr (assoc 0 ed)))
    (setq ed (entget en))
    (princ ed)
    (setq en (entnext en))
    (ch_hight ed (/ 4.0 5.0))))

(defun ch_hight	 (ed sc / color size)
  (setq	size  (cdr (assoc 40 ed))
	size  (text_normalize  size sc)
	color (cdr (assoc 62 ed))
	ed    (subst (cons 40 size) (assoc 40 ed) ed)
	ed    (subst (cons 62 3) (assoc 62 ed) ed))
  (entmod ed))

(defun text_size_lst  (/ rez)
  (setq	n  7
	sz 80.0)
  (while (< 0 (setq n (1- n)))
    (setq rez (cons sz rez)
	  sz  (* sz (/ 7.0 10.0))
	  rez (cons sz rez)
	  sz  (* sz (/ 5.0 7.0))))
  rez)

(defun text_normalize  (x sc / rez)
  (setq	sizes (scaled_text_size_lst sc)
	i     (length sizes))
  (while (<= 1 (setq i (1- i)))
    (setq b  (nth i sizes)
	  a  (nth (1- i) sizes)
	  sg (sqrt (* a b)))
    (cond ((<= a sg x b) (setq rez b))
	  ((<= a x sg b) (setq rez a)))
    rez))

(defun scaled_text_size_lst  (scl) 
  (mapcar (function (lambda (el) (* el scl)))(text_size_lst)))































































































































































































































































































































































































































































































































(mapcar (function (lambda (el) (* 0.1 el))) (text_size_lst))












































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































