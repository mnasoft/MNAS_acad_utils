<html>
<head>
 <style>
   .colortext {
     color: red; /* Красный цвет выделения */
   }
</style>
</head>
<h1>0. Получение комплекса программ</h1>
<p>Комплекс программ доступен для скачивания в двух вариантах в виде:</p>
<ul>
<li>установочного файла;</li>
<li>исходных файлов.</li>
</ul>
<h2>0.1	Получение установочного файла</h2>
<p>Установочный файл можно скачать по приведенным ниже адресам:</p>
<ol>
<li>http://mnasoft.mksat.net/Products/MNAS_AutoCAD_db17_utils/ - (все версии) главный сайт проекта.</li>
<li>http://dwg.ru/dnl/11383 - (версия 3.0.0.2)</li>
<li>http://dwg.ru/dnl/10039 - (версия 2.7.7.5)</li>
<li>http://dwg.ru/dnl/8319  - (версия 2.7.6)</li>
</ol>
<h2>0.2	Сборка установочного файла из исходных файлов</h2>
<h3>0.2.1 Рекомендуемое программное обеспечение для сборки из исходных файлов</h3>
<p>Перечень рекомендуемого программного обеспечение для сборки комплекса программ из исходных файлов:</p>
<ul>
<li>NSIS 2.46. Для сборки установщика.<br />
Сайт: http://nsis.sourceforge.net/Download<br />
Степень необходимости: обязательно.</li>
<li>Python 3.3.2. Для сборки установщика.<br />
Сайт: http://www.python.org/<br />
Степень необходимости: обязательно.</li>
<li>GIT. Для получения исходных файлов в виде git-репозитория.<br />Сайт: http://git-scm.com/download/win<br />Степень необходимости: не обязательно.</li>
<li>MSYS-1.0.11.<br />
Сайт: http://sourceforge.net/projects/mingw/files/MSYS/Base/msys-core/msys-1.0.11/MSYS-1.0.11.exe<br />
Степень необходимости: не обязательно.</li>
<li>MinGW. Для пересборки сценария сборки пакета установки.<br />
Сайт: http://sourceforge.net/projects/mingw/files/Installer/mingw-get-inst/<br />
Степень необходимости: не обязательно.</li>
<li>Notepad++. Для редактирования отдельных файлов.<br />
Сайт: http://notepad-plus-plus.org/<br />
Степень необходимости: не обязательно.</li>
</ul>
<h3>0.2.2	Получение исходных файлов</h3>
Исходные файлы можно получитьт с сайта https://github.com/mnasoft/MNAS_acad_utils в виде:
<ul>
<li>zip-архива.<br />
После скачивания zip-архива необходимо выполнить его распаковку;<li>
<li>git-репозитория git://github.com/mnasoft/MNAS_acad_utils.git.<br />
Скачать git-репозиторий можно при помощи команды:<br />
<code>
    git clone git://github.com/mnasoft/MNAS_acad_utils.git
</code>
</ul>
<h3>0.2.3 Компиляция vlx приложений из исходных файлов</h3>
Здесь возможны два варианта:
<ul>
<li>для компиляции исходных файлов в автоматичеком режиме выполните 0.2.3.1.</li>
<li>для компиляции исходных файлов в в ручном режиме выполните 0.2.3.2.</li>
</ul>
<h4>0.2.3.1 Компиляция vlx приложений из исходных файлов в автоматичеком режиме</h4>
<ol>
<li>При помощи редактора окорректируйле файл ...\acad_setup_js\VLISP_make_prv.js таким образом, чтобы переменная
<code><pre>acad_w_path="E:\\home\\namatv\\git\\GitHub\\MNAS_acad_utils\\acad_w.sup\\";</pre></code>
приняла соответствующее вашему случаю значение. При корректировке обратите внимание на двойные обратные слеши.</li>
<li>Запустите <span class="colortext">англоязычную</span> версию AutoCAD.<br />
Для версии AutoCAD отличной от англоязычной компиляция vlx приложений из исходных файлов в автоматичеком режиме правильно работать не будет.</li>
<li><p>Перед выполнением фактических действий дочитайте данный пункт до конца.</p> <p>Запустите из программы Проводник файл ...\MNAS_acad_utils\acad_setup_js\VLISP_make_prv.js на выполнение.</p>
<span class="colortext">
<p>Внимание: сценарий эмулирует нажатие на клавиши пользователя.<br />
Сразу после его запуска прекратите нажатие клавиш на клавиатуре и щелчки мышкой.<br />
Действие данного сценария завершится через 2-7 минут.</p></span>
<p>Если при его выполнении происходят ошибки не предпринимайте никаких действий до его окончания.<br />
По окончании его выполнения проверьте значение переменной acad_w_path из файла ...\MNAS_acad_utils\acad_setup_js\VLISP_make_prv.js, закорйте vlisp и повторите настоящий пункт.</p>
<p>По окончании выполнения VLISP_make_prv.js проверьте содержимое каталога ...\MNAS_acad_utils\vlx. В нем должны появиться скомпилированные VLX-файлы.</p>
<p>
</p></li>
</ol>
<h4>0.2.3.2 Компиляция vlx приложений из исходных файлов в ручном режиме</h4>
<ol>
<li>Запустите AutoCAD.</li>
<li>Выполните команду <code>vlisp</code> AutoCAD.</li>
<li>При помощи программы "Visual LISP", используя меню "Файл->Собрать приложение->Собрать приложение ...", соберите нижеперечисленные приложения:
<code><pre>
...\MNAS_acad_utils\acad_w.sup\abrev\Abrev.prv
...\MNAS_acad_utils\acad_w.sup\acad_pgp\ACAD_PGP.prv
...\MNAS_acad_utils\acad_w.sup\add_prefix\Add_prefix.prv
...\MNAS_acad_utils\acad_w.sup\atoms\atoms.prv
...\MNAS_acad_utils\acad_w.sup\axis\Axis.prv
...\MNAS_acad_utils\acad_w.sup\axis\axis_podp.prv
...\MNAS_acad_utils\acad_w.sup\big_fnt\big_fnt.prv
...\MNAS_acad_utils\acad_w.sup\change\Change.prv
...\MNAS_acad_utils\acad_w.sup\circles\CIRCLES.prv
...\MNAS_acad_utils\acad_w.sup\clock\Clock.prv
...\MNAS_acad_utils\acad_w.sup\dims\dims.prv
...\MNAS_acad_utils\acad_w.sup\dims\dim_style\dim_style.prv
...\MNAS_acad_utils\acad_w.sup\dims\rou\rou.prv
...\MNAS_acad_utils\acad_w.sup\dims\rou_1\rou_1.prv
...\MNAS_acad_utils\acad_w.sup\dims\welding\Welding1.prv
...\MNAS_acad_utils\acad_w.sup\dxf\dxf.prv
...\MNAS_acad_utils\acad_w.sup\d_chprop\D_chprop.prv
...\MNAS_acad_utils\acad_w.sup\edit\EDIT.prv
...\MNAS_acad_utils\acad_w.sup\entmake\ENTMAKE.prv
...\MNAS_acad_utils\acad_w.sup\exel\Exel.prv
...\MNAS_acad_utils\acad_w.sup\format\format.prv
...\MNAS_acad_utils\acad_w.sup\fors_rh\fors_rh.prv
...\MNAS_acad_utils\acad_w.sup\for_lic\For_lic.prv
...\MNAS_acad_utils\acad_w.sup\graf\Graf.prv
...\MNAS_acad_utils\acad_w.sup\hpgl\HPGL.prv
...\MNAS_acad_utils\acad_w.sup\kompas\kompas.prv
...\MNAS_acad_utils\acad_w.sup\layer\layer.prv
...\MNAS_acad_utils\acad_w.sup\lines\lines.prv
...\MNAS_acad_utils\acad_w.sup\lopatka\Lopatka.prv
...\MNAS_acad_utils\acad_w.sup\man\man.prv
...\MNAS_acad_utils\acad_w.sup\mnas\Pozition\pozition.prv
...\MNAS_acad_utils\acad_w.sup\mnas\Welding\welding.prv
...\MNAS_acad_utils\acad_w.sup\mnas\Welding_lsp\\welding_lsp.prv
...\MNAS_acad_utils\acad_w.sup\M_utils_loader\M_utils_loader.prv
...\MNAS_acad_utils\acad_w.sup\otvjerstija\f_otv.prv
...\MNAS_acad_utils\acad_w.sup\piping\pipe.prv");
...\MNAS_acad_utils\acad_w.sup\point\point.prv
...\MNAS_acad_utils\acad_w.sup\prj\arx_dbx_reg\\create_registry.prv
...\MNAS_acad_utils\acad_w.sup\prj\Spring\Spring.prv
...\MNAS_acad_utils\acad_w.sup\provoloka\provoloka.prv
...\MNAS_acad_utils\acad_w.sup\razvertka\razvertka.prv
...\MNAS_acad_utils\acad_w.sup\rename\rename.prv
...\MNAS_acad_utils\acad_w.sup\scr\scr.prv
...\MNAS_acad_utils\acad_w.sup\smesitel_vla\SMESITEL_vla.prv
...\MNAS_acad_utils\acad_w.sup\sort_shp\Sort_shp.prv
...\MNAS_acad_utils\acad_w.sup\spec\spec.prv
...\MNAS_acad_utils\acad_w.sup\text\text.prv
...\MNAS_acad_utils\acad_w.sup\dopusk\Dopusk.prv
</pre></code></li>
</ol>
<h3>0.2.4 Сборка установщика</h3>
<ol>
<li>Запустите Python_(command line) или IDLE_(Python_GUI).</li>
<li>Перейдите в корневой каталог проекта при помощи следующих команд:
<code><pre>
>>> import os
>>> os.chdir('E:\\home\\namatv\\git\\GitHub\\MNAS_acad_utils') # Заданный в кавычках путь адаптируйте для вашего случая.
</pre></code></li>
<li>Загрузите модуль nsi при помощи следующей команды:
<code><pre>
>>> import nsi
</pre></code></li>
<li>Сгенерируйте файл сценария установщика MNAS_acad_utils.nsi при помощи следующей команды:
<code><pre>
>>> nsi.create_nsi()
</pre></code></li>
<li>Закройте Python_(command line) или IDLE_(Python_GUI) при помощи следующей команы:
<code><pre>
>>> quit()
</pre></code></li>
<li>Перейдите при помощи программы Проводник в каталог, содержащий файл MNAS_acad_utils.nsi (корневой каталог проекта).</li>
<li>При помощи контекстного меню (вызывается щелчком по файлу правой кнопкой мыши), вызванного для файла MNAS_acad_utils.nsi, выберите пункт "Compile NSYS Script" или "Compile NSYS Script (Choose Compressor)".</li>
</ol>

<h1>1. Инструкция по установке и настройке комплекса программ MNAS_acad_utils для Администратора</h1>
<h2>1.1	Установка пакета MNAS_acad_utils </h2>
<p>Установите пакет MNAS_acad_utils-X.Х.Х.Х.exe. Запомните имя каталога, в который в будет установлен комплекс программ, (Далее по тексту ...= путь установки комплекса программ).</p>
<h2>1.2 Настройка разрешений</h2>
<p>Предполагаается, что в процессе работы с комплексом программ пользователь будет подгружать частичное меню и возможно, захочет что-то поправить в исходном коде программ.</p>
<p>Для обеспечения вышеуказанных возможностей разрешите изменение содержимого каталога с комплексом программ для пользователей, которые будут с ним работать.</p>

<h2>1.3	Настройка системного реестра.</h2>
<ol>
<li>Запустите AutoCAD.</li>
<li>При помощи команды APPLOAD загрузите приложение к AutoCAD "...\vlx\M_utils_loader.VLX"</li>
<li>Выполните команду AutoCAD   MNASOFT-REGISTRY-INSTALL.</li>
<li>Завершите сеанс работы с AutoCAD.</li>
<li>Если Вы собираетесь работать под Административной записью в AutoCAD с использованием комплекса программ MNAS_acad_utils - выполните шаги, описанные в п.2</li>
</ol>

<h1>2. Инструкция по настройке комплекса программ MNAS_acad_utils для Пользователя AutoCAD</h1>
<h2>2.1 Очистка записей с информацией о промежуточных данных работы команд комплекта из системного реестра</h2>
Если вы переходите из версии MNAS_AutoCAD_db17_utils-2.3 или более ранней - удалите из системного реестра папку  HKEY_CURRENT_USER\Software\MNASoft.<br />
Для удаления воспользуйтесь программой regedit.

<h2>2.2 Настройка AutoCAD для работы с комплексом программ MNAS_AutoCAD_db17_utils.</h2>
<p>Запустите AutoCAD на выполнение.</p>

<h2>2.3 Добавление путей для поиска файлов адаптации</h2>
<ol>
<li>Выполните команду AutoCAD _options.</li>
<li>В диалоге "Настройка" ("Options") перейдите на вкладку "Файлы" ("Files").</li>
<li>Выберите элемент "Путь доступа к вспомогательным файлам" ("Support File Search Path").</li>
<li>Добавьте перечисленные ниже пути:</li>
<ul>
<li>"..." ;</li>
<li>"...\acad_fnt" ;</li>
<li>"...\acad_fnt\kompas";</li>
<li>"...\acad.mnu\Acad_mnu_icon" .</li>
</ul>
<li>Закройте диалог.</li>
</ol>
<h2>2.4 Загрузка файла меню частичной адаптации.</h2>
<ol>
<li>Выполните команду AutoCAD <code>"_cui"</code>.</li>
<li>В диалоге "Адаптация пользовательского интерфейса" ("Customize User Interface") перейдите на вкладку "Адаптация" ("Customize").</li>
<li>Нажмите кнопку "Загрузить файл частичной адаптации" ("Load partial customization file"), расположенную на панели инструментов (открытая папка с знаком +).</li>
<li>В диалоге "Открыть" выберите файл "...\AutoCAD.mnu\MNASoft_18.cuix" .</li>
<li>Закройте диалог "Адаптация пользовательского интерфейса" ("Customize User Interface").</li>
</ol>

<h2>2.5 Перезапуск AutoCAD.</h2>
<p>Для версий AutoCAD до 2013 необходим перезапуск, чтобы пути адаптации начали действовать.</p>
<ol>
<li>Завершите сеанс AutoCAD.</li>
<li>Повторно запустите AutoCAD.</li>
</ol>

<h2>2.6 Получение списка команд MNAS_acad_utils.</h2>
<p> Ознакомьтесь со списком команд, определенных в комплексе программ MNAS_acad_utils, их краткое описание можно просмотреть, вызвав команду MAN.</p>

<h3>Приятной работы с использованием комплекса программ MNAS_acad_utils.</h3>

<h1>3. Инструкция по деинсталяции комплекса программ MNAS_acad_utils для Пользователя AutoCAD</h1>
<h2>3.1 Вызрузка файла меню частичной адаптации</h2>

<ol>
<li>Запустите AutoCAD</li>
<li>Выполните команду AutoCAD _cui.</li>
<li>В диалоге "Адаптация пользовательского интерфейса" перейдите на вкладку "Адаптация".</li>
<li>В выпадающем списке "Адаптации" выберите элемент "Все файлы адаптации".</li>
<li>Раскройте элемент "Файлы частичной адаптации".</li>
<li>Вызовите контекстное меню элемента "MNASOFT".</li>
<li>Выберите из контекстного меню элемент "Выгрузить MNASOFT_18.CUIX".</li>
<li>Закройте диалог "Адаптация пользовательского интерфейса".</li>
</ol>

<h2>3.2 Удаление путей поиска файлов адаптации.</h2>
<ol>
<li>Выполните команду AutoCAD _options.</li>
<li>В диалоге "Настройка" перейдите на вкладку "Файлы".</li>
<li>Выберите элемент "Путь доступа к вспомогательным файлам".</li>
<li>Удалите пути, добавленные в пункте 2.3.</li>
<li>Закройте диалог "Настройка"</li>
</ol>
<h3><p>Приятной работы без использования комплекса программ MNAS_acad_utils.</p></h3>

<h1>4. Инструкция по деинсталяции комплекса программ MNAS_acad_utils для Администратора</h1>
<h2>Очистка системного реестра.</h2>
<ol>
<li>Запустите AutoCAD.</li>
<li>При помощи команды APPLOAD загрузите приложение к AutoCAD "...\vlx\M_utils_loader.VLX"</li>
<li>Выполните команду AutoCAD MNASOFT-REGISTRY-UNINSTALL.</li>
<li>Завершите сеанс работы с AutoCAD.</li>
<li>Используя диалог "Установка и удаление программ" "Панели инструментов" удалите комплекс программ MNAS_acad_utils.</li>
</ol>
</html>